<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>decorrelation - Test</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../styles.css">
<meta property="og:title" content="decorrelation - Test">
<meta property="og:description" content="In this tutorial, we demostrate how to use Dask for distributed computing.">
<meta property="og:site-name" content="decorrelation">
<meta name="twitter:title" content="decorrelation - Test">
<meta name="twitter:description" content="In this tutorial, we demostrate how to use Dask for distributed computing.">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">decorrelation</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/kanglcn/decorrelation"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Test</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">decorrelation</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">API</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../API/co.html" class="sidebar-item-text sidebar-link">co</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../API/pl.html" class="sidebar-item-text sidebar-link">pl</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../API/plot.html" class="sidebar-item-text sidebar-link">Plot</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../API/shp.html" class="sidebar-item-text sidebar-link">shp</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Tutorials</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Tutorials/Adaptive_Multilook.html" class="sidebar-item-text sidebar-link">Adaptive Multilook</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Tutorials/DS_Processing.html" class="sidebar-item-text sidebar-link">DS Processing</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Tutorials/work_with_dask.html" class="sidebar-item-text sidebar-link active">Test</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#processing" id="toc-processing" class="nav-link active" data-scroll-target="#processing">Processing</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/kanglcn/decorrelation/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Test</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->
<div class="cell" data-tags="[]" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> zarr</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> cupy <span class="im">as</span> cp</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itertools <span class="im">import</span> product</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> decorrelation.shp <span class="im">import</span> ks_test</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> decorrelation.co <span class="im">import</span> emperical_co_sp</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> decorrelation.pl <span class="im">import</span> emi</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> dask <span class="im">import</span> array <span class="im">as</span> da</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> dask <span class="im">import</span> delayed</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> dask.distributed <span class="im">import</span> Client, LocalCluster</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> dask_cuda <span class="im">import</span> LocalCUDACluster</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>cluster <span class="op">=</span> LocalCUDACluster()</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>client <span class="op">=</span> Client(cluster)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>client</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>2023-04-12 15:46:27,548 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-04-12 15:46:27,548 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-04-12 15:46:27,548 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-04-12 15:46:27,548 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="3">

<div>
    <div style="width: 24px; height: 24px; background-color: #e1e1e1; border: 3px solid #9D9D9D; border-radius: 5px; position: absolute;"> </div>
    <div style="margin-left: 48px;">
        <h3 style="margin-bottom: 0px;" class="anchored">Client</h3>
        <p style="color: #9D9D9D; margin-bottom: 0px;">Client-18cf4702-d973-11ed-b624-248a07c15530</p>
        <table style="width: 100%; text-align: left;">

        <tbody><tr>
        
            <td style="text-align: left;"><strong>Connection method:</strong> Cluster object</td>
            <td style="text-align: left;"><strong>Cluster type:</strong> dask_cuda.LocalCUDACluster</td>
        
        </tr>

        
            <tr>
                <td style="text-align: left;">
                    <strong>Dashboard: </strong> <a href="http://127.0.0.1:8787/status" target="_blank">http://127.0.0.1:8787/status</a>
                </td>
                <td style="text-align: left;"></td>
            </tr>
        

        </tbody></table>

        

        
            <details>
            <summary style="margin-bottom: 20px;"><h3 style="display: inline;" class="anchored">Cluster Info</h3></summary>
            <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-mod-trusted jp-OutputArea-output">
    <div style="width: 24px; height: 24px; background-color: #e1e1e1; border: 3px solid #9D9D9D; border-radius: 5px; position: absolute;">
    </div>
    <div style="margin-left: 48px;">
        <h3 style="margin-bottom: 0px; margin-top: 0px;" class="anchored">LocalCUDACluster</h3>
        <p style="color: #9D9D9D; margin-bottom: 0px;">b34b71ac</p>
        <table style="width: 100%; text-align: left;">
            <tbody><tr>
                <td style="text-align: left;">
                    <strong>Dashboard:</strong> <a href="http://127.0.0.1:8787/status" target="_blank">http://127.0.0.1:8787/status</a>
                </td>
                <td style="text-align: left;">
                    <strong>Workers:</strong> 2
                </td>
            </tr>
            <tr>
                <td style="text-align: left;">
                    <strong>Total threads:</strong> 2
                </td>
                <td style="text-align: left;">
                    <strong>Total memory:</strong> 100.00 GiB
                </td>
            </tr>
            
            <tr>
    <td style="text-align: left;"><strong>Status:</strong> running</td>
    <td style="text-align: left;"><strong>Using processes:</strong> True</td>
</tr>

            
        </tbody></table>

        <details>
            <summary style="margin-bottom: 20px;">
                <h3 style="display: inline;" class="anchored">Scheduler Info</h3>
            </summary>

            <div style="">
    <div>
        <div style="width: 24px; height: 24px; background-color: #FFF7E5; border: 3px solid #FF6132; border-radius: 5px; position: absolute;"> </div>
        <div style="margin-left: 48px;">
            <h3 style="margin-bottom: 0px;" class="anchored">Scheduler</h3>
            <p style="color: #9D9D9D; margin-bottom: 0px;">Scheduler-976162fa-b225-4ba1-b2a6-b6453c45cdda</p>
            <table style="width: 100%; text-align: left;">
                <tbody><tr>
                    <td style="text-align: left;">
                        <strong>Comm:</strong> tcp://127.0.0.1:35802
                    </td>
                    <td style="text-align: left;">
                        <strong>Workers:</strong> 2
                    </td>
                </tr>
                <tr>
                    <td style="text-align: left;">
                        <strong>Dashboard:</strong> <a href="http://127.0.0.1:8787/status" target="_blank">http://127.0.0.1:8787/status</a>
                    </td>
                    <td style="text-align: left;">
                        <strong>Total threads:</strong> 2
                    </td>
                </tr>
                <tr>
                    <td style="text-align: left;">
                        <strong>Started:</strong> Just now
                    </td>
                    <td style="text-align: left;">
                        <strong>Total memory:</strong> 100.00 GiB
                    </td>
                </tr>
            </tbody></table>
        </div>
    </div>

    <details style="margin-left: 48px;">
        <summary style="margin-bottom: 20px;">
            <h3 style="display: inline;" class="anchored">Workers</h3>
        </summary>

        
        <div style="margin-bottom: 20px;">
            <div style="width: 24px; height: 24px; background-color: #DBF5FF; border: 3px solid #4CC9FF; border-radius: 5px; position: absolute;"> </div>
            <div style="margin-left: 48px;">
            <details>
                <summary>
                    <h4 style="margin-bottom: 0px; display: inline;" class="anchored">Worker: 0</h4>
                </summary>
                <table style="width: 100%; text-align: left;">
                    <tbody><tr>
                        <td style="text-align: left;">
                            <strong>Comm: </strong> tcp://127.0.0.1:43875
                        </td>
                        <td style="text-align: left;">
                            <strong>Total threads: </strong> 1
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Dashboard: </strong> <a href="http://127.0.0.1:43682/status" target="_blank">http://127.0.0.1:43682/status</a>
                        </td>
                        <td style="text-align: left;">
                            <strong>Memory: </strong> 50.00 GiB
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Nanny: </strong> tcp://127.0.0.1:33124
                        </td>
                        <td style="text-align: left;"></td>
                    </tr>
                    <tr>
                        <td colspan="2" style="text-align: left;">
                            <strong>Local directory: </strong> /tmp/dask-worker-space/worker-y2n75el4
                        </td>
                    </tr>

                    
                    <tr>
                        <td style="text-align: left;">
                            <strong>GPU: </strong>Tesla V100-SXM2-32GB
                        </td>
                        <td style="text-align: left;">
                            <strong>GPU memory: </strong> 31.75 GiB
                        </td>
                    </tr>
                    

                    

                </tbody></table>
            </details>
            </div>
        </div>
        
        <div style="margin-bottom: 20px;">
            <div style="width: 24px; height: 24px; background-color: #DBF5FF; border: 3px solid #4CC9FF; border-radius: 5px; position: absolute;"> </div>
            <div style="margin-left: 48px;">
            <details>
                <summary>
                    <h4 style="margin-bottom: 0px; display: inline;" class="anchored">Worker: 1</h4>
                </summary>
                <table style="width: 100%; text-align: left;">
                    <tbody><tr>
                        <td style="text-align: left;">
                            <strong>Comm: </strong> tcp://127.0.0.1:45311
                        </td>
                        <td style="text-align: left;">
                            <strong>Total threads: </strong> 1
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Dashboard: </strong> <a href="http://127.0.0.1:34893/status" target="_blank">http://127.0.0.1:34893/status</a>
                        </td>
                        <td style="text-align: left;">
                            <strong>Memory: </strong> 50.00 GiB
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Nanny: </strong> tcp://127.0.0.1:32823
                        </td>
                        <td style="text-align: left;"></td>
                    </tr>
                    <tr>
                        <td colspan="2" style="text-align: left;">
                            <strong>Local directory: </strong> /tmp/dask-worker-space/worker-t0kxqwae
                        </td>
                    </tr>

                    
                    <tr>
                        <td style="text-align: left;">
                            <strong>GPU: </strong>Tesla V100-SXM2-32GB
                        </td>
                        <td style="text-align: left;">
                            <strong>GPU memory: </strong> 31.75 GiB
                        </td>
                    </tr>
                    

                    

                </tbody></table>
            </details>
            </div>
        </div>
        

    </details>
</div>

        </details>
    </div>
</div>
            </details>
        

    </div>
</div>
</div>
</div>
<p>In this tutorial, we demostrate how to use <code>Dask</code> for distributed computing.</p>
<p>Two significant issues for InSAR big data processing are: 1) the memory of CPU/GPU does not fit the volume of very big data; 2) the processing speed is limited. For the first issue, one common solution is divide the data into independent chunks and process the chunks one by one. In many case, the processing of chunks are independent. Thus the processing can be speeded up by parallel processing.</p>
<p><code>Dask</code> is a job scheduler that allows deploying process-level parallel processing. Through the <code>Delayed</code> feature, <code>Dask</code> operations only construct the computing workflow rather than do the computation immediately. All of the computations are done at the end to allow <code>Dask</code> better distributing computing resources for the task. <code>Dask</code> makes the parallel processing easier and enable the decoupling of codes for computation and codes for scheduling.</p>
<p>In this demo, we use <code>Dask</code> for multi-GPU KS test. This includes:</p>
<ul>
<li>Read SLC data from disk to CPU and then transfer to GPU;</li>
<li>Divide them into overlapped chunks;</li>
<li>Apply the <a href="https://kanglcn.github.io/decorrelation/API/shp.html#ks_test"><code>ks_test</code></a> to each chunks;</li>
<li>Trim the overlapping in the results;</li>
<li>Transfer the results to CPU;</li>
<li>Save data to disk.</li>
</ul>
<section id="processing" class="level2">
<h2 class="anchored" data-anchor-id="processing">Processing</h2>
<p>Load data into CPU, the chunk size is setted:</p>
<div class="cell" data-tags="[]" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>rslc_path <span class="op">=</span> <span class="st">'../../data/rslc.zarr'</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>rslc_zarr <span class="op">=</span> zarr.<span class="bu">open</span>(rslc_path,mode<span class="op">=</span><span class="st">'r'</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>cpu_rslc <span class="op">=</span> da.from_zarr(rslc_path,chunks<span class="op">=</span>(<span class="dv">1000</span>,<span class="dv">1000</span>,<span class="dv">17</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then convert to GPU:</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>rslc <span class="op">=</span> cpu_rslc.map_blocks(cp.asarray)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>rslc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">

<table>
    <tbody><tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 594.67 MiB </td>
                        <td> 129.70 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (2500, 1834, 17) </td>
                        <td> (1000, 1000, 17) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 6 chunks in 3 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> complex64 cupy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="156" height="208" style="stroke:rgb(0,0,0);stroke-width:1">

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2"></line>
  <line x1="10" y1="48" x2="80" y2="118"></line>
  <line x1="10" y1="88" x2="80" y2="158" style="stroke-width:2"></line>

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="88" style="stroke-width:2"></line>
  <line x1="38" y1="28" x2="38" y2="116"></line>
  <line x1="66" y1="56" x2="66" y2="144"></line>
  <line x1="80" y1="70" x2="80" y2="158" style="stroke-width:2"></line>

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,158.62023529411766 10.0,88.032" style="fill:#ECB172A0;stroke-width:0"></polygon>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="35" y2="0" style="stroke-width:2"></line>
  <line x1="38" y1="28" x2="63" y2="28"></line>
  <line x1="66" y1="56" x2="91" y2="56"></line>
  <line x1="80" y1="70" x2="106" y2="70" style="stroke-width:2"></line>

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2"></line>
  <line x1="35" y1="0" x2="106" y2="70" style="stroke-width:2"></line>

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 35.41261651458248,0.0 106.00085180870013,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"></polygon>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="106" y2="70" style="stroke-width:2"></line>
  <line x1="80" y1="118" x2="106" y2="118"></line>
  <line x1="80" y1="158" x2="106" y2="158" style="stroke-width:2"></line>

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="158" style="stroke-width:2"></line>
  <line x1="106" y1="70" x2="106" y2="158" style="stroke-width:2"></line>

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 106.00085180870013,70.58823529411765 106.00085180870013,158.62023529411766 80.58823529411765,158.62023529411766" style="fill:#ECB172A0;stroke-width:0"></polygon>

  <!-- Text -->
  <text x="93.294544" y="178.620235" font-size="1.0rem" font-weight="100" text-anchor="middle">17</text>
  <text x="126.000852" y="114.604235" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,126.000852,114.604235)">1834</text>
  <text x="35.294118" y="143.326118" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,143.326118)">2500</text>
</svg>
        </td>
    </tr>
</tbody></table>
</div>
</div>
<p>Prepare the <code>rmli</code> and processing parameters:</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>rmli <span class="op">=</span> da.<span class="bu">abs</span>(rslc)<span class="op">**</span><span class="dv">2</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>rmli</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">

<table>
    <tbody><tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 297.34 MiB </td>
                        <td> 64.85 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (2500, 1834, 17) </td>
                        <td> (1000, 1000, 17) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 6 chunks in 5 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 cupy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="156" height="208" style="stroke:rgb(0,0,0);stroke-width:1">

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2"></line>
  <line x1="10" y1="48" x2="80" y2="118"></line>
  <line x1="10" y1="88" x2="80" y2="158" style="stroke-width:2"></line>

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="88" style="stroke-width:2"></line>
  <line x1="38" y1="28" x2="38" y2="116"></line>
  <line x1="66" y1="56" x2="66" y2="144"></line>
  <line x1="80" y1="70" x2="80" y2="158" style="stroke-width:2"></line>

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,158.62023529411766 10.0,88.032" style="fill:#ECB172A0;stroke-width:0"></polygon>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="35" y2="0" style="stroke-width:2"></line>
  <line x1="38" y1="28" x2="63" y2="28"></line>
  <line x1="66" y1="56" x2="91" y2="56"></line>
  <line x1="80" y1="70" x2="106" y2="70" style="stroke-width:2"></line>

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2"></line>
  <line x1="35" y1="0" x2="106" y2="70" style="stroke-width:2"></line>

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 35.41261651458248,0.0 106.00085180870013,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"></polygon>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="106" y2="70" style="stroke-width:2"></line>
  <line x1="80" y1="118" x2="106" y2="118"></line>
  <line x1="80" y1="158" x2="106" y2="158" style="stroke-width:2"></line>

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="158" style="stroke-width:2"></line>
  <line x1="106" y1="70" x2="106" y2="158" style="stroke-width:2"></line>

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 106.00085180870013,70.58823529411765 106.00085180870013,158.62023529411766 80.58823529411765,158.62023529411766" style="fill:#ECB172A0;stroke-width:0"></polygon>

  <!-- Text -->
  <text x="93.294544" y="178.620235" font-size="1.0rem" font-weight="100" text-anchor="middle">17</text>
  <text x="126.000852" y="114.604235" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,126.000852,114.604235)">1834</text>
  <text x="35.294118" y="143.326118" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,143.326118)">2500</text>
</svg>
        </td>
    </tr>
</tbody></table>
</div>
</div>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>az_half_win <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>r_half_win <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>az_win <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>az_half_win<span class="op">+</span><span class="dv">1</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>r_win <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>r_half_win<span class="op">+</span><span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Enable overlapping between chunks. This is because the KS test is conducted on small region (az_win*r_win).</p>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>depth <span class="op">=</span> {<span class="dv">0</span>:az_half_win, <span class="dv">1</span>:r_half_win, <span class="dv">2</span>:<span class="dv">0</span>}<span class="op">;</span> boundary <span class="op">=</span> {<span class="dv">0</span>:<span class="st">'none'</span>,<span class="dv">1</span>:<span class="st">'none'</span>,<span class="dv">2</span>:<span class="st">'none'</span>}</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>rmli_overlap <span class="op">=</span> da.overlap.overlap(rmli,depth<span class="op">=</span>depth, boundary<span class="op">=</span>boundary)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>rmli_overlap</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">

<table>
    <tbody><tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 301.35 MiB </td>
                        <td> 65.83 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (2520, 1844, 17) </td>
                        <td> (1010, 1005, 17) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 6 chunks in 6 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 cupy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="156" height="208" style="stroke:rgb(0,0,0);stroke-width:1">

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2"></line>
  <line x1="10" y1="47" x2="80" y2="118"></line>
  <line x1="10" y1="87" x2="80" y2="158" style="stroke-width:2"></line>

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="87" style="stroke-width:2"></line>
  <line x1="38" y1="28" x2="38" y2="115"></line>
  <line x1="66" y1="56" x2="66" y2="144"></line>
  <line x1="80" y1="70" x2="80" y2="158" style="stroke-width:2"></line>

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,158.39775910364148 10.0,87.80952380952381" style="fill:#ECB172A0;stroke-width:0"></polygon>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="35" y2="0" style="stroke-width:2"></line>
  <line x1="38" y1="28" x2="63" y2="28"></line>
  <line x1="66" y1="56" x2="91" y2="56"></line>
  <line x1="80" y1="70" x2="106" y2="70" style="stroke-width:2"></line>

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2"></line>
  <line x1="35" y1="0" x2="106" y2="70" style="stroke-width:2"></line>

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 35.41261651458248,0.0 106.00085180870013,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"></polygon>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="106" y2="70" style="stroke-width:2"></line>
  <line x1="80" y1="118" x2="106" y2="118"></line>
  <line x1="80" y1="158" x2="106" y2="158" style="stroke-width:2"></line>

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="158" style="stroke-width:2"></line>
  <line x1="106" y1="70" x2="106" y2="158" style="stroke-width:2"></line>

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 106.00085180870013,70.58823529411765 106.00085180870013,158.39775910364148 80.58823529411765,158.39775910364148" style="fill:#ECB172A0;stroke-width:0"></polygon>

  <!-- Text -->
  <text x="93.294544" y="178.397759" font-size="1.0rem" font-weight="100" text-anchor="middle">17</text>
  <text x="126.000852" y="114.492997" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,126.000852,114.492997)">1844</text>
  <text x="35.294118" y="143.103641" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,143.103641)">2520</text>
</svg>
        </td>
    </tr>
</tbody></table>
</div>
</div>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the array of delayed object will lost some shape information so perserve them here</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>chunks_size <span class="op">=</span> rmli_overlap.chunks </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>nchunks <span class="op">=</span> <span class="bu">tuple</span>(<span class="bu">len</span>(nchunks_in_each_dim) <span class="cf">for</span> nchunks_in_each_dim <span class="kw">in</span> chunks_size)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>chunks_shape <span class="op">=</span> <span class="bu">list</span>(product(<span class="op">*</span>chunks_size))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>chunks_size</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>((1005, 1010, 505), (1005, 839), (17,))</code></pre>
</div>
</div>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>nchunks</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>(3, 2, 1)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>chunks_shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>[(1005, 1005, 17),
 (1005, 839, 17),
 (1010, 1005, 17),
 (1010, 839, 17),
 (505, 1005, 17),
 (505, 839, 17)]</code></pre>
</div>
</div>
<p>Convert each chunk to delayed object;</p>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>rmli_chunks <span class="op">=</span> rmli_overlap.to_delayed()</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>rmli_chunks</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>array([[[Delayed(('overlap-deeb6bf02a78ef34f82e8a8fcbd6af40', 0, 0, 0))],
        [Delayed(('overlap-deeb6bf02a78ef34f82e8a8fcbd6af40', 0, 1, 0))]],

       [[Delayed(('overlap-deeb6bf02a78ef34f82e8a8fcbd6af40', 1, 0, 0))],
        [Delayed(('overlap-deeb6bf02a78ef34f82e8a8fcbd6af40', 1, 1, 0))]],

       [[Delayed(('overlap-deeb6bf02a78ef34f82e8a8fcbd6af40', 2, 0, 0))],
        [Delayed(('overlap-deeb6bf02a78ef34f82e8a8fcbd6af40', 2, 1, 0))]]],
      dtype=object)</code></pre>
</div>
</div>
<p>Apply the KS test:</p>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>delayed_ks_test <span class="op">=</span> delayed(ks_test,pure<span class="op">=</span><span class="va">True</span>,nout<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> [delayed_ks_test(rmli_chunk,az_half_win<span class="op">=</span>az_half_win,r_half_win<span class="op">=</span>r_half_win) <span class="cf">for</span> rmli_chunk <span class="kw">in</span> rmli_chunks.ravel()]</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>dist_chunks, p_chunks <span class="op">=</span> <span class="bu">zip</span>(<span class="op">*</span>results)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>dist_chunks, p_chunks <span class="op">=</span> np.array(dist_chunks), np.array(p_chunks)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>dist_chunks</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>array([Delayed('getitem-f50335529b047b79b2c90cdef57d40fd'),
       Delayed('getitem-4ce12862641d4b5c6c4cc84e652dabc2'),
       Delayed('getitem-c0334ded367e1297dcd1fed323c211e8'),
       Delayed('getitem-da7af3e1e8721cc553402893fa56e087'),
       Delayed('getitem-237696b05fba3e9aec0a3bc835be6a4b'),
       Delayed('getitem-cac2e878f9a43c9f1da9233851482b57')], dtype=object)</code></pre>
</div>
</div>
<p>Convert <code>Delayed</code> object to dask array:</p>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(chunks_shape)):</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>    dist_chunks[i] <span class="op">=</span> da.from_delayed(dist_chunks[i],shape<span class="op">=</span>(<span class="op">*</span>chunks_shape[i][:<span class="op">-</span><span class="dv">1</span>],az_win,r_win),meta<span class="op">=</span>cp.array((),dtype<span class="op">=</span>rmli.dtype))</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    p_chunks[i] <span class="op">=</span> da.from_delayed(p_chunks[i],shape<span class="op">=</span>(<span class="op">*</span>chunks_shape[i][:<span class="op">-</span><span class="dv">1</span>],az_win,r_win),meta<span class="op">=</span>cp.array((),dtype<span class="op">=</span>rmli.dtype))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>dist_chunks</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<pre><code>array([dask.array&lt;from-value, shape=(1005, 1005, 11, 11), dtype=float32, chunksize=(1005, 1005, 11, 11), chunktype=cupy.ndarray&gt;,
       dask.array&lt;from-value, shape=(1005, 839, 11, 11), dtype=float32, chunksize=(1005, 839, 11, 11), chunktype=cupy.ndarray&gt;,
       dask.array&lt;from-value, shape=(1010, 1005, 11, 11), dtype=float32, chunksize=(1010, 1005, 11, 11), chunktype=cupy.ndarray&gt;,
       dask.array&lt;from-value, shape=(1010, 839, 11, 11), dtype=float32, chunksize=(1010, 839, 11, 11), chunktype=cupy.ndarray&gt;,
       dask.array&lt;from-value, shape=(505, 1005, 11, 11), dtype=float32, chunksize=(505, 1005, 11, 11), chunktype=cupy.ndarray&gt;,
       dask.array&lt;from-value, shape=(505, 839, 11, 11), dtype=float32, chunksize=(505, 839, 11, 11), chunktype=cupy.ndarray&gt;],
      dtype=object)</code></pre>
</div>
</div>
<p>Reshape and concentate the dask array:</p>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>dist_chunks, p_chunks <span class="op">=</span> dist_chunks.reshape((<span class="op">*</span>nchunks,<span class="dv">1</span>)).tolist(), p_chunks.reshape((<span class="op">*</span>nchunks,<span class="dv">1</span>)).tolist()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>dist_chunks</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>[[[[dask.array&lt;from-value, shape=(1005, 1005, 11, 11), dtype=float32, chunksize=(1005, 1005, 11, 11), chunktype=cupy.ndarray&gt;]],
  [[dask.array&lt;from-value, shape=(1005, 839, 11, 11), dtype=float32, chunksize=(1005, 839, 11, 11), chunktype=cupy.ndarray&gt;]]],
 [[[dask.array&lt;from-value, shape=(1010, 1005, 11, 11), dtype=float32, chunksize=(1010, 1005, 11, 11), chunktype=cupy.ndarray&gt;]],
  [[dask.array&lt;from-value, shape=(1010, 839, 11, 11), dtype=float32, chunksize=(1010, 839, 11, 11), chunktype=cupy.ndarray&gt;]]],
 [[[dask.array&lt;from-value, shape=(505, 1005, 11, 11), dtype=float32, chunksize=(505, 1005, 11, 11), chunktype=cupy.ndarray&gt;]],
  [[dask.array&lt;from-value, shape=(505, 839, 11, 11), dtype=float32, chunksize=(505, 839, 11, 11), chunktype=cupy.ndarray&gt;]]]]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>dist <span class="op">=</span> da.block(dist_chunks)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> da.block(p_chunks)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>dist</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">

<table>
    <tbody><tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 2.09 GiB </td>
                        <td> 468.53 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (2520, 1844, 11, 11) </td>
                        <td> (1010, 1005, 11, 11) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 6 chunks in 23 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 cupy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="507" height="127" style="stroke:rgb(0,0,0);stroke-width:1">

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2"></line>
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2"></line>

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2"></line>
  <line x1="47" y1="0" x2="47" y2="25"></line>
  <line x1="95" y1="0" x2="95" y2="25"></line>
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2"></line>

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"></polygon>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle">2520</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>


  <!-- Horizontal lines -->
  <line x1="190" y1="0" x2="241" y2="51" style="stroke-width:2"></line>
  <line x1="190" y1="25" x2="241" y2="77" style="stroke-width:2"></line>

  <!-- Vertical lines -->
  <line x1="190" y1="0" x2="190" y2="25" style="stroke-width:2"></line>
  <line x1="218" y1="28" x2="218" y2="53"></line>
  <line x1="241" y1="51" x2="241" y2="77" style="stroke-width:2"></line>

  <!-- Colored Rectangle -->
  <polygon points="190.0,0.0 241.65266106442579,51.65266106442577 241.65266106442579,77.06527757900825 190.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"></polygon>

  <!-- Horizontal lines -->
  <line x1="190" y1="0" x2="215" y2="0" style="stroke-width:2"></line>
  <line x1="218" y1="28" x2="243" y2="28"></line>
  <line x1="241" y1="51" x2="267" y2="51" style="stroke-width:2"></line>

  <!-- Vertical lines -->
  <line x1="190" y1="0" x2="241" y2="51" style="stroke-width:2"></line>
  <line x1="215" y1="0" x2="267" y2="51" style="stroke-width:2"></line>

  <!-- Colored Rectangle -->
  <polygon points="190.0,0.0 215.41261651458248,0.0 267.06527757900824,51.65266106442577 241.65266106442579,51.65266106442577" style="fill:#ECB172A0;stroke-width:0"></polygon>

  <!-- Horizontal lines -->
  <line x1="241" y1="51" x2="267" y2="51" style="stroke-width:2"></line>
  <line x1="241" y1="77" x2="267" y2="77" style="stroke-width:2"></line>

  <!-- Vertical lines -->
  <line x1="241" y1="51" x2="241" y2="77" style="stroke-width:2"></line>
  <line x1="267" y1="51" x2="267" y2="77" style="stroke-width:2"></line>

  <!-- Colored Rectangle -->
  <polygon points="241.65266106442579,51.65266106442577 267.0652775790083,51.65266106442577 267.0652775790083,77.06527757900825 241.65266106442579,77.06527757900825" style="fill:#ECB172A0;stroke-width:0"></polygon>

  <!-- Text -->
  <text x="254.358969" y="97.065278" font-size="1.0rem" font-weight="100" text-anchor="middle">11</text>
  <text x="287.065278" y="64.358969" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,287.065278,64.358969)">11</text>
  <text x="205.826331" y="71.238947" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,205.826331,71.238947)">1844</text>
</svg>
        </td>
    </tr>
</tbody></table>
</div>
</div>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">

<table>
    <tbody><tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 2.09 GiB </td>
                        <td> 468.53 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (2520, 1844, 11, 11) </td>
                        <td> (1010, 1005, 11, 11) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 6 chunks in 23 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 cupy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="507" height="127" style="stroke:rgb(0,0,0);stroke-width:1">

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2"></line>
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2"></line>

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2"></line>
  <line x1="47" y1="0" x2="47" y2="25"></line>
  <line x1="95" y1="0" x2="95" y2="25"></line>
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2"></line>

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"></polygon>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle">2520</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>


  <!-- Horizontal lines -->
  <line x1="190" y1="0" x2="241" y2="51" style="stroke-width:2"></line>
  <line x1="190" y1="25" x2="241" y2="77" style="stroke-width:2"></line>

  <!-- Vertical lines -->
  <line x1="190" y1="0" x2="190" y2="25" style="stroke-width:2"></line>
  <line x1="218" y1="28" x2="218" y2="53"></line>
  <line x1="241" y1="51" x2="241" y2="77" style="stroke-width:2"></line>

  <!-- Colored Rectangle -->
  <polygon points="190.0,0.0 241.65266106442579,51.65266106442577 241.65266106442579,77.06527757900825 190.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"></polygon>

  <!-- Horizontal lines -->
  <line x1="190" y1="0" x2="215" y2="0" style="stroke-width:2"></line>
  <line x1="218" y1="28" x2="243" y2="28"></line>
  <line x1="241" y1="51" x2="267" y2="51" style="stroke-width:2"></line>

  <!-- Vertical lines -->
  <line x1="190" y1="0" x2="241" y2="51" style="stroke-width:2"></line>
  <line x1="215" y1="0" x2="267" y2="51" style="stroke-width:2"></line>

  <!-- Colored Rectangle -->
  <polygon points="190.0,0.0 215.41261651458248,0.0 267.06527757900824,51.65266106442577 241.65266106442579,51.65266106442577" style="fill:#ECB172A0;stroke-width:0"></polygon>

  <!-- Horizontal lines -->
  <line x1="241" y1="51" x2="267" y2="51" style="stroke-width:2"></line>
  <line x1="241" y1="77" x2="267" y2="77" style="stroke-width:2"></line>

  <!-- Vertical lines -->
  <line x1="241" y1="51" x2="241" y2="77" style="stroke-width:2"></line>
  <line x1="267" y1="51" x2="267" y2="77" style="stroke-width:2"></line>

  <!-- Colored Rectangle -->
  <polygon points="241.65266106442579,51.65266106442577 267.0652775790083,51.65266106442577 267.0652775790083,77.06527757900825 241.65266106442579,77.06527757900825" style="fill:#ECB172A0;stroke-width:0"></polygon>

  <!-- Text -->
  <text x="254.358969" y="97.065278" font-size="1.0rem" font-weight="100" text-anchor="middle">11</text>
  <text x="287.065278" y="64.358969" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,287.065278,64.358969)">11</text>
  <text x="205.826331" y="71.238947" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,205.826331,71.238947)">1844</text>
</svg>
        </td>
    </tr>
</tbody></table>
</div>
</div>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>dist.chunks</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>((1005, 1010, 505), (1005, 839), (11,), (11,))</code></pre>
</div>
</div>
<p>Trim the overlap region:</p>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>depth <span class="op">=</span> {<span class="dv">0</span>:az_half_win, <span class="dv">1</span>:r_half_win, <span class="dv">2</span>:<span class="dv">0</span>, <span class="dv">3</span>:<span class="dv">0</span>}<span class="op">;</span> boundary <span class="op">=</span> {<span class="dv">0</span>:<span class="st">'none'</span>,<span class="dv">1</span>:<span class="st">'none'</span>,<span class="dv">2</span>:<span class="st">'none'</span>,<span class="dv">3</span>:<span class="st">'none'</span>}</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>dist <span class="op">=</span> da.overlap.trim_overlap(dist,depth<span class="op">=</span>depth,boundary<span class="op">=</span>boundary)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> da.overlap.trim_overlap(p,depth<span class="op">=</span>depth,boundary<span class="op">=</span>boundary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>dist.chunks</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<pre><code>((1000, 1000, 500), (1000, 834), (11,), (11,))</code></pre>
</div>
</div>
<p>Copy data from GPU to CPU:</p>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>cpu_dist <span class="op">=</span> da.map_blocks(cp.asnumpy,dist)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>cpu_p <span class="op">=</span> da.map_blocks(cp.asnumpy,p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>cpu_dist</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">

<table>
    <tbody><tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 2.07 GiB </td>
                        <td> 461.58 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (2500, 1834, 11, 11) </td>
                        <td> (1000, 1000, 11, 11) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 6 chunks in 26 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="507" height="127" style="stroke:rgb(0,0,0);stroke-width:1">

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2"></line>
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2"></line>

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2"></line>
  <line x1="48" y1="0" x2="48" y2="25"></line>
  <line x1="96" y1="0" x2="96" y2="25"></line>
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2"></line>

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"></polygon>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle">2500</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>


  <!-- Horizontal lines -->
  <line x1="190" y1="0" x2="241" y2="51" style="stroke-width:2"></line>
  <line x1="190" y1="25" x2="241" y2="77" style="stroke-width:2"></line>

  <!-- Vertical lines -->
  <line x1="190" y1="0" x2="190" y2="25" style="stroke-width:2"></line>
  <line x1="218" y1="28" x2="218" y2="53"></line>
  <line x1="241" y1="51" x2="241" y2="77" style="stroke-width:2"></line>

  <!-- Colored Rectangle -->
  <polygon points="190.0,0.0 241.7835294117647,51.783529411764704 241.7835294117647,77.19614592634719 190.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"></polygon>

  <!-- Horizontal lines -->
  <line x1="190" y1="0" x2="215" y2="0" style="stroke-width:2"></line>
  <line x1="218" y1="28" x2="243" y2="28"></line>
  <line x1="241" y1="51" x2="267" y2="51" style="stroke-width:2"></line>

  <!-- Vertical lines -->
  <line x1="190" y1="0" x2="241" y2="51" style="stroke-width:2"></line>
  <line x1="215" y1="0" x2="267" y2="51" style="stroke-width:2"></line>

  <!-- Colored Rectangle -->
  <polygon points="190.0,0.0 215.41261651458248,0.0 267.1961459263472,51.783529411764704 241.7835294117647,51.783529411764704" style="fill:#ECB172A0;stroke-width:0"></polygon>

  <!-- Horizontal lines -->
  <line x1="241" y1="51" x2="267" y2="51" style="stroke-width:2"></line>
  <line x1="241" y1="77" x2="267" y2="77" style="stroke-width:2"></line>

  <!-- Vertical lines -->
  <line x1="241" y1="51" x2="241" y2="77" style="stroke-width:2"></line>
  <line x1="267" y1="51" x2="267" y2="77" style="stroke-width:2"></line>

  <!-- Colored Rectangle -->
  <polygon points="241.7835294117647,51.783529411764704 267.1961459263472,51.783529411764704 267.1961459263472,77.19614592634719 241.7835294117647,77.19614592634719" style="fill:#ECB172A0;stroke-width:0"></polygon>

  <!-- Text -->
  <text x="254.489838" y="97.196146" font-size="1.0rem" font-weight="100" text-anchor="middle">11</text>
  <text x="287.196146" y="64.489838" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,287.196146,64.489838)">11</text>
  <text x="205.891765" y="71.304381" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,205.891765,71.304381)">1834</text>
</svg>
        </td>
    </tr>
</tbody></table>
</div>
</div>
<p>Save the data to disk:</p>
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>cpu_dist.to_zarr(<span class="st">'dist.zarr'</span>,overwrite<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>cpu_p.to_zarr(<span class="st">'p.zarr'</span>,overwrite<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>CPU times: user 909 ms, sys: 885 ms, total: 1.79 s
Wall time: 39.1 s</code></pre>
</div>
</div>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>dask_dist <span class="op">=</span> zarr.load(<span class="st">'dist.zarr'</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>dask_p <span class="op">=</span> zarr.load(<span class="st">'p.zarr'</span>)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>dist <span class="op">=</span> zarr.load(<span class="st">'../../data/dist_ks.zarr/'</span>)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> zarr.load(<span class="st">'../../data/p_ks.zarr/'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>np.testing.assert_array_equal(dask_dist,dist)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>np.testing.assert_array_equal(dask_p,p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
<ul>
<li>Dask can benifit when the GPU memory is not enough;</li>
<li>Dask allows multi-gpu parallel processing.</li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>